<!-- Header -->
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
  <h1 class="h2"><%= pageTitle %></h1>
  <div class="btn-toolbar mb-2 mb-md-0">
    <a href="/admin/transportations/create" class="btn btn-primary">
      <i class="fas fa-plus me-2"></i>Thêm phương tiện
    </a>
  </div>
  </div>

<!-- Flash -->
<% if (typeof flash !== 'undefined' && flash.error && flash.error.length > 0) { %>
  <div class="alert alert-danger alert-dismissible fade show" role="alert">
    <%= flash.error[0] %>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>
<% } %>
<% if (typeof flash !== 'undefined' && flash.success && flash.success.length > 0) { %>
  <div class="alert alert-success alert-dismissible fade show" role="alert">
    <%= flash.success[0] %>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>
<% } %>

<!-- Filters -->
<form class="row g-2 mb-3" method="GET" action="/admin/transportations">
  <div class="col-md-3">
    <input type="text" name="search" value="<%= search || '' %>" class="form-control" placeholder="Tìm theo tên, mô tả, tag...">
  </div>
  <div class="col-md-3">
    <select name="category" class="form-select">
      <option value="">Tất cả danh mục</option>
      <% (categories||[]).forEach(c => { %>
        <option value="<%= c.value %>" <%= category===c.value?'selected':'' %>><%= c.label %></option>
      <% }) %>
    </select>
  </div>
  <div class="col-md-3">
    <select name="type" class="form-select">
      <option value="">Tất cả loại</option>
      <% (types||[]).forEach(t => { %>
        <option value="<%= t.value %>" <%= type===t.value?'selected':'' %>><%= t.label %></option>
      <% }) %>
    </select>
  </div>
  <div class="col-md-2">
    <select name="status" class="form-select">
      <option value="">Tất cả trạng thái</option>
      <option value="featured" <%= status==='featured'?'selected':'' %>>Nổi bật</option>
      <option value="active" <%= status==='active'?'selected':'' %>>Kích hoạt</option>
      <option value="inactive" <%= status==='inactive'?'selected':'' %>>Chưa kích hoạt</option>
    </select>
  </div>
  <div class="col-md-1 d-grid">
    <button class="btn btn-outline-secondary" type="submit"><i class="fas fa-search"></i></button>
  </div>
  </form>

<!-- Table -->
<div class="card">
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-striped align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th>Tên</th>
            <th>Danh mục</th>
            <th>Loại</th>
            <th>Tags</th>
            <th>Trạng thái</th>
            <th style="width:160px"></th>
          </tr>
        </thead>
        <tbody>
          <% (transportations||[]).forEach(item => { %>
            <tr>
              <td>
                <div class="fw-semibold"><a href="/admin/transportations/<%= item._id %>"><%= item.name %></a></div>
                <div class="text-muted small"><%= item.nameEn || '' %></div>
              </td>
              <td><span class="badge text-bg-info"><%= item.category %></span></td>
              <td><span class="badge text-bg-secondary"><%= item.type %></span></td>
              <td>
                <% (item.tags||[]).slice(0,3).forEach(tag => { %>
                  <span class="badge text-bg-light border me-1"><%= tag %></span>
                <% }) %>
                <% if ((item.tags||[]).length>3) { %><span class="text-muted small">+<%= item.tags.length-3 %></span><% } %>
              </td>
              <td>
                <% if (item.featured) { %><span class="badge text-bg-primary me-1">Nổi bật</span><% } %>
                <% if (item.isActive) { %><span class="badge text-bg-success">Kích hoạt</span><% } else { %><span class="badge text-bg-secondary">Tắt</span><% } %>
              </td>
              <td class="text-end">
                <a href="/admin/transportations/edit/<%= item._id %>" class="btn btn-sm btn-outline-primary me-1"><i class="fas fa-edit"></i></a>
                <form method="POST" action="/admin/transportations/delete/<%= item._id %>" style="display:inline" onsubmit="return confirm('Xóa mục này?')">
                  <button class="btn btn-sm btn-outline-danger"><i class="fas fa-trash"></i></button>
                </form>
              </td>
            </tr>
          <% }) %>
          <% if (!transportations || transportations.length===0) { %>
          <tr><td colspan="6" class="text-center text-muted py-4">Chưa có dữ liệu</td></tr>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
  <div class="card-footer d-flex justify-content-between align-items-center">
    <nav>
      <ul class="pagination mb-0">
        <% const cp = currentPage || 1; const tp = totalPages || 1; %>
        <li class="page-item <%= cp<=1?'disabled':'' %>"><a class="page-link" href="?page=<%= cp-1 %>&search=<%= search||'' %>&category=<%= category||'' %>&type=<%= type||'' %>&status=<%= status||'' %>">Trước</a></li>
        <li class="page-item disabled"><span class="page-link">Trang <%= cp %>/<%= tp %></span></li>
        <li class="page-item <%= cp>=tp?'disabled':'' %>"><a class="page-link" href="?page=<%= cp+1 %>&search=<%= search||'' %>&category=<%= category||'' %>&type=<%= type||'' %>&status=<%= status||'' %>">Sau</a></li>
      </ul>
    </nav>
  </div>
  </div>


